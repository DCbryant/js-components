<!DOCTYPE html>
<html>
<head>
<script src="http://kejian.jirengu.com/static/js/jquery-1.11.1.min.js"></script>

  <meta charset="utf-8">
  <title></title>
  <style>
    ul,li{
      list-style:none;
    }
    .container{
      max-width: 600px;
      margin: 0 auto;
    }
    .container:after{
    	content: '';
    	display: block;
    	clear: both;
    }
    .container li{
      float: left;
      margin: 10px 10px;
    }
    .container li img{
      width: 280px;
      height: 280px;
    }
    p{
      float: left;
    }
  </style>
 
</head>
<body>
    <ul class="container">
    <li><a href="#"><img src="http://kejian.jirengu.com/data/fe/%E8%AF%BE%E4%BB%B6/32-%E6%87%92%E5%8A%A0%E8%BD%BD/code/blank.jpg" data-src="http://cdn.jirengu.com/book.jirengu.com/img/1.jpg" /></a></li>
    <li><a href="#"><img src="http://kejian.jirengu.com/data/fe/%E8%AF%BE%E4%BB%B6/32-%E6%87%92%E5%8A%A0%E8%BD%BD/code/blank.jpg" data-src="http://cdn.jirengu.com/book.jirengu.com/img/1.jpg" /></a></li>
    <li><a href="#"><img src="http://kejian.jirengu.com/data/fe/%E8%AF%BE%E4%BB%B6/32-%E6%87%92%E5%8A%A0%E8%BD%BD/code/blank.jpg" data-src="http://cdn.jirengu.com/book.jirengu.com/img/2.jpg" /></a></li>
    <li><a href="#"><img src="http://kejian.jirengu.com/data/fe/%E8%AF%BE%E4%BB%B6/32-%E6%87%92%E5%8A%A0%E8%BD%BD/code/blank.jpg" data-src="http://cdn.jirengu.com/book.jirengu.com/img/3.jpg" /></a></li>
    <li><a href="#"><img src="http://kejian.jirengu.com/data/fe/%E8%AF%BE%E4%BB%B6/32-%E6%87%92%E5%8A%A0%E8%BD%BD/code/blank.jpg" data-src="http://cdn.jirengu.com/book.jirengu.com/img/4.jpg" /></a></li>
    <li><a href="#"><img src="http://kejian.jirengu.com/data/fe/%E8%AF%BE%E4%BB%B6/32-%E6%87%92%E5%8A%A0%E8%BD%BD/code/blank.jpg" data-src="http://cdn.jirengu.com/book.jirengu.com/img/5.jpg" /></a></li>
    <li><a href="#"><img src="http://kejian.jirengu.com/data/fe/%E8%AF%BE%E4%BB%B6/32-%E6%87%92%E5%8A%A0%E8%BD%BD/code/blank.jpg" data-src="http://cdn.jirengu.com/book.jirengu.com/img/6.jpg" /></a></li>
    <li><a href="#"><img src="http://kejian.jirengu.com/data/fe/%E8%AF%BE%E4%BB%B6/32-%E6%87%92%E5%8A%A0%E8%BD%BD/code/blank.jpg" data-src="http://cdn.jirengu.com/book.jirengu.com/img/7.jpg" /></a></li>
    <li><a href="#"><img src="http://kejian.jirengu.com/data/fe/%E8%AF%BE%E4%BB%B6/32-%E6%87%92%E5%8A%A0%E8%BD%BD/code/blank.jpg" data-src="http://cdn.jirengu.com/book.jirengu.com/img/8.jpg" /></a></li>
    <li><a href="#"><img src="http://kejian.jirengu.com/data/fe/%E8%AF%BE%E4%BB%B6/32-%E6%87%92%E5%8A%A0%E8%BD%BD/code/blank.jpg" data-src="http://cdn.jirengu.com/book.jirengu.com/img/9.jpg" /></a></li>
    <li><a href="#"><img src="http://kejian.jirengu.com/data/fe/%E8%AF%BE%E4%BB%B6/32-%E6%87%92%E5%8A%A0%E8%BD%BD/code/blank.jpg" data-src="http://cdn.jirengu.com/book.jirengu.com/img/10.jpg" /></a></li>
    <li><a href="#"><img src="http://kejian.jirengu.com/data/fe/%E8%AF%BE%E4%BB%B6/32-%E6%87%92%E5%8A%A0%E8%BD%BD/code/blank.jpg" data-src="http://cdn.jirengu.com/book.jirengu.com/img/11.jpg" /></a></li>
    <li><a href="#"><img src="http://kejian.jirengu.com/data/fe/%E8%AF%BE%E4%BB%B6/32-%E6%87%92%E5%8A%A0%E8%BD%BD/code/blank.jpg" data-src="http://cdn.jirengu.com/book.jirengu.com/img/12.jpg" /></a></li>
    <li><a href="#"><img src="http://kejian.jirengu.com/data/fe/%E8%AF%BE%E4%BB%B6/32-%E6%87%92%E5%8A%A0%E8%BD%BD/code/blank.jpg" data-src="http://cdn.jirengu.com/book.jirengu.com/img/13.jpg" /></a></li>
    <li><a href="#"><img src="http://kejian.jirengu.com/data/fe/%E8%AF%BE%E4%BB%B6/32-%E6%87%92%E5%8A%A0%E8%BD%BD/code/blank.jpg" data-src="http://cdn.jirengu.com/book.jirengu.com/img/14.jpg" /></a></li>
    <li><a href="#"><img src="http://kejian.jirengu.com/data/fe/%E8%AF%BE%E4%BB%B6/32-%E6%87%92%E5%8A%A0%E8%BD%BD/code/blank.jpg" data-src="http://cdn.jirengu.com/book.jirengu.com/img/15.jpg" /></a></li>
    <li><a href="#"><img src="http://kejian.jirengu.com/data/fe/%E8%AF%BE%E4%BB%B6/32-%E6%87%92%E5%8A%A0%E8%BD%BD/code/blank.jpg" data-src="http://cdn.jirengu.com/book.jirengu.com/img/16.jpg" /></a></li><li><a href="#"><img src="http://kejian.jirengu.com/data/fe/%E8%AF%BE%E4%BB%B6/32-%E6%87%92%E5%8A%A0%E8%BD%BD/code/blank.jpg" data-src="http://cdn.jirengu.com/book.jirengu.com/img/17.jpg" /></a></li>
    <p id="hello">hello</p>
    <p id="world">world</p>

    </ul>

    <script type="text/javascript">
        var Lazy =(function(){ 
            function Exposure($target,callback,isOnce){
                this.$target = $target;
                this.callback = callback;
                this.isOnce = isOnce;
                this.hasShow = false; //用于判断是否继续执行
                this.bind();
                this.check();     
            }
            Exposure.prototype = {
                constructor:Exposure,
                showImg:function($node){
                    var imgUrl = $node.attr('data-src')
                    $node.attr('src',imgUrl)
                },
                bind:function(){
                    var _this = this;
                    $(window).on('scroll', function(){
                        _this.check();
                    })
                },
                check:function(){
                    if(this.isOnce){// 如果传入第3个参数就执行；
                        if(this.isShow() && !this.hasShow){//当hasShow为true就不再执行，因此就只执行一次
                            this.callback(this.$target)
                            this.hasShow = true;
                        }
                    }else{// 如果没有传入第3个参数就执行；
                        if(this.isShow()){
                            this.callback(this.$target)       
                        }    
                    }  
                },
                isShow:function(){
                    var windowHeight = $(window).height()
                    var scrollTop = $(window).scrollTop()
                    var offsetTop = this.$target.offset().top
                    var nodeHeight = this.$target.height()
                    if(windowHeight+scrollTop>offsetTop && scrollTop< offsetTop+nodeHeight){
                        return true;
                    }else{
                        return false;
                    }  
                }
            }
            return {
                init :function($targets,callback){//多次执行callback;
                    $targets.each(function(index,target){
                        new Exposure($(target),callback)
                    })
                },
                one:function($target,callback){//执行一次callback;
                    $target.each(function(index,target){
                        new Exposure($(target),callback,true)
                    })
                }
            }
       })()
       
        Lazy.one($('#hello'),function($node){
             $node.text($node.text()+'只加一次');
        })
        Lazy.init($('#world'),function($node){
             $node.text($node.text()+'加多次');
        })
       Lazy.one($('.container img'),function($node){
            this.showImg($node);
       })
    </script>

</body>
</html>